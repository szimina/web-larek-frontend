# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


## Компоненты слоя данных (Model) 
1. ###Класс  Item 
Содержит информацию о товаре, получаемую через api и включает в себя следующие аргументы:
- **id**: string; // идентификатор товара, используется при открытии карточки товара, добавлении или удалении товара из корзины
- **description**: string; // текст описания товара, используемый в карточке товара
-  **image**: string; // иконка-изобращение товара
-  **title**: string; // название товара
-  **category**: string; //категория товара
- **price**: number; // цена товара

Данный класс не содержит методов.

2. ###Класс AppState
Содержит информацию о товарах и заказе:
- **catalog**: Item[]; // список-каталог всех объектов класса Item, полученных по api
**order**: IOrder = { // информацию о самом заказе пользователя
    **email**: string; // мейл пользователя
    **phone**: string; // контактный телефон пользователя
    **address**: string; // адрес доставки
    **payment**: string; // выбранный способ оплаты
    **items**: string[]; //список id товаров, который пользователь добавил в корзину
    **total**: number; // итоговую стоимость заказа
  };
  **formErrors**: FormErrors //информацию об ошибках воода информации в форму заказа

####Методы класса:

- **setCatalog** // отвечает за добавление товаров в каталог после получения их по api
- **setPreview** // отвечает за установку события 'preview:changed' на выбранную пользователем карточку товара и дальнейшее открыте модального окна с подробным описанием данного товара
- **toggleOrderedLot** // отвечает за добавление или исключение товаров из корзины
- **getTotal** // возвращает итоговую стоимость всех товаров, добавленных в корзину
- **getBasketItems** // возвращает список всех товаров, добавленных пользователем в корзину
- **setOrderField** // отвечает за сохранение данных, введенных в поля заказа пользователем
- **validateOrder** // отвечает за валидацию полей формы: 
- **clearBasket** // отвечает за очищение данных заказа из аргумента order после успешной отправки заказа


## Компоненты слоя отображения (View) 
1. ###Абстрактный класс Component
Является базовым компонентом и отвечает за создание HTML обертки копонентов классов, его наследующих.

####Методы класса:

- **toggleClass** // отвечает за переключение классов
- **setText** // отвечает за установку текстового содержимого
- **setDisabled**// переключает статус блокировки
- **setHidden** // скрывает содержимое
- **setVisible** // отображает содержимое
- **setImage** // устанавливает изображение и альтернативный текст для него
- **render** // возвращает корневой DOM элемент

2. ###Класс Page
Используется для отображения главной страницы.Является расширением базового абстрактного класса Component. 
 
####Методы класса:
- **set counter**// отвечает за актуальное отображение количество товаров в корзине
- **set catalog** // отвечает за отображение каталога товаров
- **set locked** // отвечает за блокировку прокрутки страницы при открытии модального окна и разблокировку прокрутки в случае закрытя модального окна. 

3. ###Класс Card
Используется для отображения единицы товара на главной странице, в модальном окне карточки товара и в модальном окне-корзине. Является расширением базового абстрактного класса Component.

Включает в себя аргументы, аналогичные аргументам класса Item. В дополнение к этому в класс добавлен аргумент count, хранящий порядковый номер товара, если он добавлен в корзину пользователем. 

Дополнительно к родительнским методам имеет ряд собственных методов сеттеров и геттеров, отвечающих за установку и получение информации из соответствующих аргуметов класса. 

4. ###Класс Modal
Является универсальным классом отображения всех модальных окон проекта и отвечает за их открытие (метод **open**), отображение (метод **render**) и закрытие (метод **close**). Является расширением базового абстрактного класса Component. 

5. ###Класс Basket
Используется для отображение элементов корзины. Является расширением базового абстрактного класса Component.

####Методы класса:

- **items** //сеттер, отвечающий за отображение списка всех добавленных пользователем в корзину товаров или фразы "Корзина пуста" в случае отсутствия добавленных товаров
-**total** //сеттер, отвечающий за отображение итоговой стоимости товаров в корзине и активацию кнопки модального окна в случае, если итоговая стоимость составляет более нуля. Нулевой стоимость может быть в том случае, если в корзину не добавлен ни один товар, либо добавлен бесплатный товар, покупка которого невозможна без дополнительной покупки платных товаров.  Согласно макету метод форматирует значение стоимости товара, добавляя разделитель разрядов в виде пробела, в случае,если его стоимость составляет более 9999 синапсов

6. ###Класс Form
Является универсальным классом отображения всех форм проекта проекта и отвечает за их валидацию (метод **set valid**), отображение текста ошибки валидации (метод **set errors**), объявление события изменение ввода (метод **OnInputChange**)  Является расширением базового абстрактного класса Component.

7. ###Классы OrderAddress и OrderContacts
Используются для отображение форм заказа (форма с вводом адреса и форма с вводом контактов). Являеются расширением  класса Form. Имеют методы, отображающие информацию в полях, если до этого пользователь уже вводил информацию (адрес, телефон, e-mail) или выбирал способ оплаты, а затем закрыл форму заказа, не завершив покупку.

8. ###Класс Success
Используется для отображения окна успешного совершения заказа.  Является расширением базового абстрактного класса Component. Единственным методом класса является **set total**, устанавлиающий отображение итоговой стоимости заказа. 


## Компоненты слоя коммуникации (Communication)
1. ###Класс larekAPI
Отвечает за обмен информацией с сервером посредством api.

####Методы класса:
- **getItem** // позволяет получить описание конкретной единицы товара, принимая id товара в качестве аргумента
- **getItemList** //позволяет получить список товаров с сервера
- **orderItems** // передает на сервер информацию о заказе

2. ###Взаимодействия через события между классами
Описано в файле index.ts и реализуется через **класс EventEmitter**, имеющий методы установки обработчки событий (**on**), снятия обработчика событий (**off**) и инициализацию события (**emit**).

####Список событий:
- **'modal:open'** и **'modal:close'** // отвечают за блокировку и разблокировку прокрутки основной страницы при открытии модального окна
- **'preview:changed'** // отвечает за открытие модального окна с описанием карточки  товара, вешает слушатель на кнопку модального окна. Если товар ранее был добавлен в корзину, на кнопку вешается слушатель 'basket:open' а текст на кнопке отоборажается как "В корзине", в противном случае вешается слушатель 'item:add' и на кнопке отображается текст "Купить". 
- **'item:add'** // отвечает за добавление товара в корзину, изменение цифры на счетчике корзины и закрытие модального окна сразу же при добавлении товара в корзину
- **'card:select'** // отвечает за подготовку карточки к открытию
- **'basket:open'** // отвечает за открытие корзины и генерацию карточек товара, которые были ранее добавлены пользователем в корзину, и за выведение итоговой стоимости всех товаров, добавленных в корзину
- **'item:remove'** //отвечает за удаление товара из корзины и заказа и обновление счетчика количества товаров в корзине
- **'order:open'** // отвечает за отображение формы заказа. Если ранее пользователь уже выбирал метод оплаты и вводил адрес доставки, подставляет значения в поля и производит валидацию
- **'order:cash'** и **'order:card'** // отвечает за события, связанные с выбором кнопки - метода оплаты, устанавливая выбранные з начения в заказ и производя валидацию формы
- **/^order\..*:change/ и /^contacts\..*:change/**  // отвечает за сохранение введенных даных в одноименные поля ввода в форму заказа и в форму контактов соответсвтенно
- **'formErrors:change'** // отвечает за изменение состояния валидации формы 
- **'order:submit'** //  отвечает за отображение формы контактов. Если ранее пользователь уже выбирал метод оплаты и вводил адрес доставки, подставляет значения в поля и производит валидацию
- **'contacts:submit'** // отвечает за отправку заказа по api и обнуление данных заказа в корзине
- **'items:changed'** // отчвечает за отображенеи всех карточек товара на главной странице